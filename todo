#!/usr/local/bin/python3

import sqlite3 as sqlite
import sys

DATABASE_NAME = "todolist.db"

def init():
    conn = sqlite.connect(DATABASE_NAME)
    with conn:
        cur = conn.cursor()
        cur.execute("CREATE TABLE IF NOT EXISTS task(description TEXT)")

def add(param):
    conn = sqlite.connect(DATABASE_NAME)	
    with conn:
        cur = conn.cursor()
        sql = "INSERT INTO task(description) values (?)"
        cur.execute(sql, [param])
        conn.commit()

def list():
    conn = sqlite.connect(DATABASE_NAME)
    with conn:
        cur = conn.cursor()
        sql = "SELECT * FROM task"
        cur.execute(sql)
        index = 1
        for task in cur.fetchall():
            print("[" + str(index) + "] " +task[0])
            index += 1

def remove(desc):
    conn = sqlite.connect(DATABASE_NAME)
    with conn:
        cur = conn.cursor()
        sql = "DELETE FROM task WHERE description == (?)"
        cur.execute(sql, [desc])

def main(argv):
    init()
    if(argv[1] == "add"):
        add(argv[2])
    if(argv[1] == "list"):
        list()
    if(argv[1] == "remove"):
        remove(argv[2])

if __name__ == "__main__":
        main(sys.argv)

        
